@using praca_dyplomowa_zesp.Models.Users

@* Ten widok jest teraz bardzo lekki. 
   Wszystkie style (inputy, fonty, tła) są w wwwroot/css/site.css.
   Tutaj tylko klasy pomocnicze dla kolorów ramek.
*@

<style>
    /* Specyficzne kolory ramek dla modali Auth (można też przenieść do site.css) */
    .auth-purple {
        border: 2px solid var(--neon-purple);
        box-shadow: 0 0 25px rgba(217, 0, 255, 0.15);
    }

    .auth-green {
        border: 2px solid var(--neon-green);
        box-shadow: 0 0 25px rgba(0, 255, 157, 0.15);
    }

    /* Separator - specyficzny dla tego layoutu */
    .auth-separator {
        display: flex;
        align-items: center;
        text-align: center;
        color: #666;
        font-family: 'Orbitron', sans-serif;
        font-size: 0.7rem;
        margin: 1.5rem 0;
        text-transform: uppercase;
    }

        .auth-separator::before, .auth-separator::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #333;
        }

        .auth-separator::before {
            margin-right: 10px;
        }

        .auth-separator::after {
            margin-left: 10px;
        }
</style>

@* --- MODAL LOGOWANIA --- *@
<div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content auth-purple">
            <div class="modal-header border-bottom-0 pb-0">
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4 p-sm-5 pt-0">

                <h2 class="text-center mb-4" style="color: #fff; text-shadow: 0 0 10px var(--neon-purple);">DOSTĘP<br>AUTORYZOWANY</h2>

                <form asp-controller="Account" asp-action="Login" method="post">
                    <input type="hidden" name="returnUrl" class="current-url-input" />

                    <div class="form-floating mb-3">
                        <input name="Login" type="text" class="form-control" placeholder="Login" required />
                        <label>LOGIN / ID</label>
                    </div>

                    <div class="form-floating mb-3">
                        <input name="Password" type="password" class="form-control" placeholder="Hasło" required />
                        <label>KOD DOSTĘPU</label>
                    </div>

                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" name="RememberMe" value="true" id="loginRememberMe" />
                        <label class="form-check-label text-muted small pt-1 text-uppercase" for="loginRememberMe">
                            PODTRZYMAJ SESJĘ
                        </label>
                    </div>

                    <div class="d-grid mb-3">
                        <button type="submit" class="btn btn-primary btn-lg">
                            INICJALIZACJA
                        </button>
                    </div>
                </form>

                <div class="auth-separator">ALTERNATYWNE POŁĄCZENIE</div>

                <form asp-controller="Account" asp-action="LoginWithSteam" method="post" class="d-grid mb-4">
                    <input type="hidden" name="returnUrl" class="current-url-input" />
                    <button type="submit" class="btn btn-secondary btn-lg" style="color: var(--neon-cyan); border-color: var(--neon-cyan);">
                        <i class="bi bi-steam fs-5 me-2"></i> ŁĄCZE STEAM
                    </button>
                </form>

                <div class="text-center mt-3">
                    <a href="#" onclick="switchToRegister()" style="color: var(--neon-green); font-weight: 700; text-transform: uppercase;">
                        >> NOWY PROFIL UŻYTKOWNIKA <<
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@* --- MODAL REJESTRACJI --- *@
<div class="modal fade" id="registerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content auth-green">
            <div class="modal-header border-bottom-0 pb-0">
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4 p-sm-5 pt-0">

                <h2 class="text-center mb-4" style="color: #fff; text-shadow: 0 0 10px var(--neon-green);">NOWY<br>UŻYTKOWNIK</h2>

                <form asp-controller="Account" asp-action="Register" method="post">
                    <input type="hidden" name="returnUrl" class="current-url-input" />

                    <div class="form-floating mb-3">
                        <input name="Login" type="text" class="form-control" placeholder="Login" required />
                        <label>USTAW ID (LOGIN)</label>
                    </div>

                    <div class="form-floating mb-3">
                        <input name="UserName" type="text" class="form-control" placeholder="Nick" required />
                        <label>NAZWA WYŚWIETLANA</label>
                    </div>

                    <div class="form-floating mb-3">
                        <input name="Password" type="password" class="form-control" placeholder="Hasło" required />
                        <label>KOD DOSTĘPU</label>
                    </div>

                    <div class="form-floating mb-4">
                        <input name="ConfirmPassword" type="password" class="form-control" placeholder="Powtórz hasło" required />
                        <label>POTWIERDŹ KOD</label>
                    </div>

                    <div class="d-grid mb-4">
                        <button type="submit" class="btn btn-success btn-lg">
                            REJESTRACJA SYSTEMU
                        </button>
                    </div>

                    <div class="text-center mt-3">
                        <a href="#" onclick="switchToLogin()" style="color: var(--neon-purple); font-weight: 700; text-transform: uppercase;">
                            >> POWRÓT DO LOGOWANIA <<
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function switchToRegister() {
        var loginModalEl = document.getElementById('loginModal');
        var registerModalEl = document.getElementById('registerModal');
        var loginModal = bootstrap.Modal.getInstance(loginModalEl);
        loginModal.hide();
        setTimeout(function() {
            var registerModal = new bootstrap.Modal(registerModalEl);
            registerModal.show();
        }, 300);
    }

    function switchToLogin() {
        var registerModalEl = document.getElementById('registerModal');
        var loginModalEl = document.getElementById('loginModal');
        var registerModal = bootstrap.Modal.getInstance(registerModalEl);
        registerModal.hide();
        setTimeout(function() {
            var loginModal = new bootstrap.Modal(loginModalEl);
            loginModal.show();
        }, 300);
    }

    document.addEventListener("DOMContentLoaded", function() {
        var currentUrl = window.location.pathname + window.location.search;
        var inputs = document.querySelectorAll('.current-url-input');
        inputs.forEach(function(input) { input.value = currentUrl; });
    });
</script>